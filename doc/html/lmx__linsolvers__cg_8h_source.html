<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>HeatSurf: src/LMX/lmx_linsolvers_cg.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HeatSurf
   &#160;<span id="projectnumber">0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_5f6c94dcb12a53d8823e293095910fa1.html">LMX</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">lmx_linsolvers_cg.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="lmx__linsolvers__cg_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/***************************************************************************</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *   Copyright (C) 2005 by Roberto Ortega                                  *</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *   rortega@mecanica.upm.es                                               *</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *                                                                         *</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *   This program is free software; you can redistribute it and/or modify  *</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *   it under the terms of the GNU Library General Public License as       *</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *   published by the Free Software Foundation; either version 2 of the    *</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *   License, or (at your option) any later version.                       *</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *                                                                         *</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *   This program is distributed in the hope that it will be useful,       *</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *   but WITHOUT ANY WARRANTY; without even the implied warranty of        *</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the         *</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *   GNU General Public License for more details.                          *</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *                                                                         *</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> *   You should have received a copy of the GNU Library General Public     *</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *   License along with this program; if not, write to the                 *</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *   Free Software Foundation, Inc.,                                       *</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> *   59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.             *</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> ***************************************************************************/</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#ifndef CG_SOLVER_H</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define CG_SOLVER_H</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="lmx__mat__vector_8h.html">lmx_mat_vector.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="keyword">namespace </span>lmx{</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="classlmx_1_1Cg.html">   53</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keyword">class </span><a class="code" href="classlmx_1_1Cg.html">Cg</a>{</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="keyword">typedef</span> <span class="keywordtype">double</span> numType;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <a class="code" href="classlmx_1_1Matrix.html">Matrix&lt;T&gt;</a> A;    <span class="comment">//+Matrix A;</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <a class="code" href="classlmx_1_1Vector.html">Vector&lt;T&gt;</a> b;    <span class="comment">//+Vector b;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <a class="code" href="classlmx_1_1Vector.html">Vector&lt;T&gt;</a> x;    <span class="comment">//+Unknown;</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        T tol;                  <span class="comment">//+Relative residual tolerance;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <a class="code" href="lmx__mat__data_8h.html#a49b489a408a211a90e766329c0732d7b">size_type</a> nrow; <span class="comment">//+Matrix size;</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <a class="code" href="lmx__mat__data_8h.html#a49b489a408a211a90e766329c0732d7b">size_type</a> kmax; <span class="comment">//+Max iterations;</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <a class="code" href="classlmx_1_1Vector.html">Vector&lt;T&gt;</a> mp;   <span class="comment">//+Preconditioner;</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <a class="code" href="classlmx_1_1Cg.html#ae188703493098d949b9f0f107a845a87">Cg</a>(<a class="code" href="classlmx_1_1Matrix.html">Matrix&lt;T&gt;</a>*, <a class="code" href="classlmx_1_1Vector.html">Vector&lt;T&gt;</a>*);     <span class="comment">//+Constructor;</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <a class="code" href="classlmx_1_1Cg.html#aca7ad968e0ed9d6bf08bdc4f4ba6ddbc">~Cg</a>();                                          <span class="comment">//+Destructor;</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <a class="code" href="classlmx_1_1Vector.html">Vector&lt;T&gt;</a> <a class="code" href="classlmx_1_1Cg.html#a78b28ffbb590c2126b0fecc972368661">solve</a>( <span class="keywordtype">int</span> );         <span class="comment">//+Solver;</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classlmx_1_1Cg.html#add75b6264e99d649c3b4723e274aa899">precond</a>();</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;};</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;} <span class="comment">//namespace lmx</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="keyword">namespace </span>lmx{</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="classlmx_1_1Cg.html#ae188703493098d949b9f0f107a845a87">   85</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <a class="code" href="classlmx_1_1Cg.html#ae188703493098d949b9f0f107a845a87">Cg&lt;T&gt;::Cg</a>(<a class="code" href="classlmx_1_1Matrix.html">Matrix&lt;T&gt;</a>* A_in, <a class="code" href="classlmx_1_1Vector.html">Vector&lt;T&gt;</a>* b_in)</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;:       A(*A_in),</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        b(*b_in),</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        x(),</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        tol(1.0e-6),</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        nrow(0), </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        kmax(0),</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        mp(*b_in)</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;{</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        nrow = A_in-&gt;rows();</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        kmax = 3*nrow;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        x.resize( nrow );</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;}</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="classlmx_1_1Cg.html#aca7ad968e0ed9d6bf08bdc4f4ba6ddbc">  103</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <a class="code" href="classlmx_1_1Cg.html#aca7ad968e0ed9d6bf08bdc4f4ba6ddbc">Cg&lt;T&gt;::~Cg</a>(){</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;}</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="classlmx_1_1Cg.html#add75b6264e99d649c3b4723e274aa899">  112</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classlmx_1_1Cg.html#add75b6264e99d649c3b4723e274aa899">Cg&lt;T&gt;::precond</a>(){</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="comment">// Diagonal preconditioner</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="lmx__mat__data_8h.html#a49b489a408a211a90e766329c0732d7b">size_type</a> i=0; i &lt; nrow; ++i) mp(i) = 1. / A.readElement(i,i);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;}</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">//+rutina para el metodo de los gradientes conjugados</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="classlmx_1_1Cg.html#a78b28ffbb590c2126b0fecc972368661">  126</a></span>&#160;<a class="code" href="classlmx_1_1Vector.html">Vector&lt;T&gt;</a> <a class="code" href="classlmx_1_1Cg.html#a78b28ffbb590c2126b0fecc972368661">Cg&lt;T&gt;::solve</a>(<span class="keywordtype">int</span> info){</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keywordflow">for</span>( i=0; i&lt;b.size(); ++i ){</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">if</span> ( b.readElement(i) != T(0) ) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keywordflow">if</span> ( i == b.size() ){</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    x=b;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    cout&lt;&lt;<span class="stringliteral">&quot;:::System solved:::&quot;</span>&lt;&lt;endl;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">return</span> x;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <a class="code" href="classlmx_1_1Vector.html">Vector&lt;T&gt;</a> r(nrow);      <span class="comment">//+Residual;</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <a class="code" href="classlmx_1_1Vector.html">Vector&lt;T&gt;</a> p(nrow);      <span class="comment">//+Search direction;</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <a class="code" href="classlmx_1_1Vector.html">Vector&lt;T&gt;</a> h(nrow);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <a class="code" href="classlmx_1_1Vector.html">Vector&lt;T&gt;</a> s(nrow);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        T delta;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        T deltaPrev;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        T alpha;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        T tole;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        T bdelta;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <a class="code" href="classlmx_1_1Vector.html">Vector&lt;T&gt;</a> vAux(nrow);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        T aux;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <a class="code" href="lmx__mat__data_8h.html#a49b489a408a211a90e766329c0732d7b">size_type</a> k=1;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">// -----</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        vAux.<a class="code" href="classlmx_1_1Vector.html#ae68d2b9e72a8a6aa9431e9dcdb126fdc">mult</a>(A,x);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        r.<a class="code" href="classlmx_1_1Vector.html#a2fb58669b0c17a07d358499500b994fd">subs</a>(b,vAux);         <span class="comment">// r = b - A*x</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        h.<a class="code" href="classlmx_1_1Vector.html#a4c799332f4f2f998330fa7525721091f">multElements</a>(mp,r);   <span class="comment">// h = mp*r;</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        delta = r*h;                    <span class="comment">// delta = r*h;</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        p = h;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        vAux.<a class="code" href="classlmx_1_1Vector.html#a4c799332f4f2f998330fa7525721091f">multElements</a>(mp,b);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        bdelta = b*vAux;                <span class="comment">// bdelta = b*mp*b</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        tole = tol*tol*bdelta;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keywordflow">while</span> (k &lt; kmax &amp;&amp; delta &gt; tole )</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                <span class="keywordflow">if</span> (info &gt; 0) cout&lt;&lt;<span class="stringliteral">&quot;iteration :&quot;</span>&lt;&lt;k&lt;&lt;<span class="stringliteral">&quot;\t&quot;</span>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                s.<a class="code" href="classlmx_1_1Vector.html#ae68d2b9e72a8a6aa9431e9dcdb126fdc">mult</a>(A,p);            <span class="comment">// s = A*p</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                aux = p*s;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                alpha = delta/aux;      <span class="comment">// alpha = delta/(p*s)</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                vAux.<a class="code" href="classlmx_1_1Vector.html#ae68d2b9e72a8a6aa9431e9dcdb126fdc">mult</a>(alpha,p);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                x += vAux;                      <span class="comment">// x = x + alpha*p</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="keywordflow">if</span>(k%50 != 0){</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                        vAux.<a class="code" href="classlmx_1_1Vector.html#ae68d2b9e72a8a6aa9431e9dcdb126fdc">mult</a>(alpha,s);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                        r -= vAux;              <span class="comment">// r = r - alpha*s</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                        vAux.<a class="code" href="classlmx_1_1Vector.html#ae68d2b9e72a8a6aa9431e9dcdb126fdc">mult</a>(A,x);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                        r.<a class="code" href="classlmx_1_1Vector.html#a2fb58669b0c17a07d358499500b994fd">subs</a>(b,vAux); <span class="comment">// r = b - A*x</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                h.<a class="code" href="classlmx_1_1Vector.html#a4c799332f4f2f998330fa7525721091f">multElements</a>(mp,r);   <span class="comment">// h = mp*r</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                deltaPrev = delta;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                delta = r*h;            <span class="comment">// delta = r*h</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                aux = delta/deltaPrev;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                vAux.<a class="code" href="classlmx_1_1Vector.html#ae68d2b9e72a8a6aa9431e9dcdb126fdc">mult</a>(aux,p);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                p.<a class="code" href="classlmx_1_1Vector.html#ab972d613ec2d693759fce1339b7c2dd7">add</a>(h,vAux);          <span class="comment">// p = h + (delta/deltaPrev)*p</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                <span class="keywordflow">if</span> (info &gt; 0) cout &lt;&lt; <span class="stringliteral">&quot;residual = &quot;</span> &lt;&lt; delta &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                <span class="keywordflow">if</span> (info &gt; 0) cout &lt;&lt; <span class="stringliteral">&quot;tolerance = &quot;</span> &lt;&lt; tole &lt;&lt; endl;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                ++k;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="keywordflow">if</span> (k==kmax)</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                cout&lt;&lt;<span class="stringliteral">&quot;:::WARNING:::&quot;</span> &lt;&lt; endl</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;:::Convegence was not achieved after &quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot; iterations.:::&quot;</span> &lt;&lt; endl</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;:::END WARNING:::&quot;</span> &lt;&lt; endl ;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        }</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                cout&lt;&lt;<span class="stringliteral">&quot;:::System solved after &quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot; iterations:::&quot;</span>&lt;&lt;endl;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="keywordflow">return</span> x;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;}</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;} <span class="comment">//namespace lmx</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="ttc" id="classlmx_1_1Vector_html_a2fb58669b0c17a07d358499500b994fd"><div class="ttname"><a href="classlmx_1_1Vector.html#a2fb58669b0c17a07d358499500b994fd">lmx::Vector::subs</a></div><div class="ttdeci">Vector &amp; subs(const Vector&lt; T &gt; &amp;, const Vector&lt; T &gt; &amp;)</div><div class="ttdef"><b>Definition:</b> lmx_mat_vector.h:664</div></div>
<div class="ttc" id="classlmx_1_1Cg_html_ae188703493098d949b9f0f107a845a87"><div class="ttname"><a href="classlmx_1_1Cg.html#ae188703493098d949b9f0f107a845a87">lmx::Cg::Cg</a></div><div class="ttdeci">Cg(Matrix&lt; T &gt; *, Vector&lt; T &gt; *)</div><div class="ttdef"><b>Definition:</b> lmx_linsolvers_cg.h:85</div></div>
<div class="ttc" id="classlmx_1_1Cg_html_aca7ad968e0ed9d6bf08bdc4f4ba6ddbc"><div class="ttname"><a href="classlmx_1_1Cg.html#aca7ad968e0ed9d6bf08bdc4f4ba6ddbc">lmx::Cg::~Cg</a></div><div class="ttdeci">~Cg()</div><div class="ttdef"><b>Definition:</b> lmx_linsolvers_cg.h:103</div></div>
<div class="ttc" id="classlmx_1_1Vector_html_a4c799332f4f2f998330fa7525721091f"><div class="ttname"><a href="classlmx_1_1Vector.html#a4c799332f4f2f998330fa7525721091f">lmx::Vector::multElements</a></div><div class="ttdeci">Vector &amp; multElements(const Vector&lt; T &gt; &amp;)</div><div class="ttdef"><b>Definition:</b> lmx_mat_vector.h:866</div></div>
<div class="ttc" id="classlmx_1_1Cg_html"><div class="ttname"><a href="classlmx_1_1Cg.html">lmx::Cg</a></div><div class="ttdoc">Template class Cg. This class implements the conjugate gradient iterative linear solver, with and without preconditioner. It uses LMX matrix and vector facilities so any kind of linked object can be used. </div><div class="ttdef"><b>Definition:</b> lmx_linsolvers_cg.h:53</div></div>
<div class="ttc" id="classlmx_1_1Cg_html_a78b28ffbb590c2126b0fecc972368661"><div class="ttname"><a href="classlmx_1_1Cg.html#a78b28ffbb590c2126b0fecc972368661">lmx::Cg::solve</a></div><div class="ttdeci">Vector&lt; T &gt; solve(int)</div><div class="ttdef"><b>Definition:</b> lmx_linsolvers_cg.h:126</div></div>
<div class="ttc" id="classlmx_1_1Matrix_html"><div class="ttname"><a href="classlmx_1_1Matrix.html">lmx::Matrix</a></div><div class="ttdef"><b>Definition:</b> lmx_mat_dense_matrix.h:39</div></div>
<div class="ttc" id="classlmx_1_1Vector_html_ab972d613ec2d693759fce1339b7c2dd7"><div class="ttname"><a href="classlmx_1_1Vector.html#ab972d613ec2d693759fce1339b7c2dd7">lmx::Vector::add</a></div><div class="ttdeci">Vector &amp; add(const Vector&lt; T &gt; &amp;, const Vector&lt; T &gt; &amp;)</div><div class="ttdef"><b>Definition:</b> lmx_mat_vector.h:641</div></div>
<div class="ttc" id="classlmx_1_1Cg_html_add75b6264e99d649c3b4723e274aa899"><div class="ttname"><a href="classlmx_1_1Cg.html#add75b6264e99d649c3b4723e274aa899">lmx::Cg::precond</a></div><div class="ttdeci">void precond()</div><div class="ttdef"><b>Definition:</b> lmx_linsolvers_cg.h:112</div></div>
<div class="ttc" id="classlmx_1_1Vector_html"><div class="ttname"><a href="classlmx_1_1Vector.html">lmx::Vector</a></div><div class="ttdoc">Template class Vector. </div><div class="ttdef"><b>Definition:</b> lmx_mat_data_mat.h:45</div></div>
<div class="ttc" id="lmx__mat__data_8h_html_a49b489a408a211a90e766329c0732d7b"><div class="ttname"><a href="lmx__mat__data_8h.html#a49b489a408a211a90e766329c0732d7b">size_type</a></div><div class="ttdeci">size_t size_type</div><div class="ttdef"><b>Definition:</b> lmx_mat_data.h:44</div></div>
<div class="ttc" id="classlmx_1_1Vector_html_ae68d2b9e72a8a6aa9431e9dcdb126fdc"><div class="ttname"><a href="classlmx_1_1Vector.html#ae68d2b9e72a8a6aa9431e9dcdb126fdc">lmx::Vector::mult</a></div><div class="ttdeci">Vector &amp; mult(const Matrix&lt; T &gt; &amp;, const Vector&lt; T &gt; &amp;)</div><div class="ttdef"><b>Definition:</b> lmx_mat_vector.h:692</div></div>
<div class="ttc" id="lmx__mat__vector_8h_html"><div class="ttname"><a href="lmx__mat__vector_8h.html">lmx_mat_vector.h</a></div><div class="ttdoc">This file contains both the declaration and implementation for Vector class member and friend functio...</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jun 4 2019 11:52:01 for HeatSurf by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
